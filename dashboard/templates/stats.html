{% extends "base.html" %}
{% block content %}

<!-- ===============================
     TOP STAT CARDS
================================ -->
<div class="chart-row three">

  <!-- SSH -->
  <div class="chart-container-wrapper">
    <div class="chart-container card-ssh" data-service="SSH">
      <div class="chart-info-wrapper">
        <h2>
          <i class="fa-solid fa-terminal"></i>
          SSH
        </h2>
        <span class="session-count">{{ stats.SSH.sessions }}</span>
      </div>

      <div class="chart-svg">
        <svg viewBox="0 0 36 36">
          <path class="circle-bg"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831"/>
          <path class="circle"
            stroke-dasharray="{{ stats.SSH.commands }},100"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831"/>
          <text x="18" y="20.35" class="percentage">
            {{ stats.SSH.commands }}
          </text>
        </svg>
      </div>
    </div>
  </div>

  <!-- FTP -->
  <div class="chart-container-wrapper">
    <div class="chart-container card-ftp" data-service="FTP">
      <div class="chart-info-wrapper">
        <h2>
          <i class="fa-solid fa-folder-open"></i>
          FTP
        </h2>
        <span class="session-count">{{ stats.FTP.sessions }}</span>
      </div>

      <div class="chart-svg">
        <svg viewBox="0 0 36 36">
          <path class="circle-bg"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831"/>
          <path class="circle"
            stroke-dasharray="{{ stats.FTP.commands }},100"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831"/>
          <text x="18" y="20.35" class="percentage">
            {{ stats.FTP.commands }}
          </text>
        </svg>
      </div>
    </div>
  </div>

  <!-- HTTP -->
  <div class="chart-container-wrapper">
    <div class="chart-container card-http" data-service="HTTP">
      <div class="chart-info-wrapper">
        <h2>
          <i class="fa-solid fa-globe"></i>
          HTTP
        </h2>
        <span class="session-count">{{ stats.HTTP.sessions }}</span>
      </div>

      <div class="chart-svg">
        <svg viewBox="0 0 36 36">
          <path class="circle-bg"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831"/>
          <path class="circle"
            stroke-dasharray="{{ stats.HTTP.commands }},100"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831"/>
          <text x="18" y="20.35" class="percentage">
            {{ stats.HTTP.commands }}
          </text>
        </svg>
      </div>
    </div>
  </div>

</div>

<!-- ===============================
     BIG CHARTS
================================ -->
<div class="chart-row charts-wide">

  <div class="chart-container-wrapper">
    <div class="chart-container chart-xxl">
      <canvas id="sessionsChart"></canvas>
    </div>
  </div>

  <div class="chart-container-wrapper">
    <div class="chart-container chart-xxl">
      <canvas id="commandsChart"></canvas>
    </div>
  </div>

  <div class="chart-container-wrapper">
    <div class="chart-container chart-xxl">
      <canvas id="severityChart"></canvas>
    </div>
  </div>

</div>

<!-- ===============================
     INITIAL DATA FOR JS
================================ -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  let statsData = {{ stats | tojson }};
</script>

{% endblock %}
